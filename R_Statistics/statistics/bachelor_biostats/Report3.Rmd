---
title: "BIO2372"
author: "Άγγελος Κοζωνάκης"
date: "12/21/2021"
output: html_document
---

**Εργαστηριακή άσκηση 3**

**Ερώτημα α**

>Αρχικά θα περάσουμε τις τιμές μας σε διανύσματα, και στη συνέχεια θα κάνουμε το διάγραμμα διασποράς.

```{r}
Temp<-c(-18,-15,-10,-5,0,5,7,10,15,19)
Oxy<-c(5.2,4.7,4.5,3.9,3.4,3.1,3.0,2.7,2.5,1.8)
plot(Temp, Oxy,pch=19, xlab="Temperature (oC)", ylab = "Oxygen (mg/g/h)")
```

>Απο το διάγραμμα, η σχέση που φαίνεται να έχει η θερμοκρασία με το ρυθμό κατανάλωσης οξυγόνου, είναι αρνητική γραμμική συσχέτιση, δηλαδή όσο αυξάνεται η θερμοκρασία, τόσο μειώνεται η κατανάλωση οξυγόνου.

```{r}
lm(Oxy ~ Temp)
```

**Εώτημα β**

>Τώρα θα φτιάξουμε την ευθεία ελαχίστων τετραγώνων. Αρχικά θα θέσουμε τις μηδενικές μας υποθέσεις, οι οποίες είναι ότι η σταθερά α (σημείο τομής αξόνων) και η κλίση της ευθείας β είναι 0 δηλαδή Η0_α:α=0 και Η0_β:β=0 ενώ εναλλακτική μας ότι δεν είναι 0 Η1_α:α≠0 και Η1_β:β≠0.

```{r}
fit <- lm(Oxy ~ Temp)
plot(Temp, Oxy)
abline(fit,col="darkgreen")
```

>Αφού φτιάξαμε την ευθεία ας ελέγξουμε τη σημαντικότητά της. Αυτό θα γίνει αναλύοντας την συνάρτηση fit.

```{r}
summary(fit)
```

>Έστω ότι η εξίσωση της ευθείας είναι y= α + βx
Οι βαθμοί ελευθερίας μας είναι 8. Βλέπουμε πως το στατιστικό για τη σταθερά α (σημείο τομής αξόνων) της ευθείας είναι tα_8=84.74 (Intercept), τυπική απόκλιση s_α=0.041867, τιμή του α=3.547941,  και p.value=4.19e-13 < 0.05.Η κλίση της ευθείας, το β (σημαντικότητα εξίσωσης ελαχίστων τετραγώνων) , έχει στατιστικό tβ_8= -24.29 (Temp), τυπική απόκλιση s_β=0.003496, τιμή του β=-0.084926 και p.value=8.80e-09 < 0.05.Άρα σε επίπεδο σημαντικότητας α=0.05 οι μηδενικές μας υπθέσεις ότι Η0_α=0 και Η0_β=0 μάλλον απορρίπτονται καθώς το p.value μας όπως είδαμε και στις 2 περιπτώσεις είναι πολύ μικρότερο απο το 0.05.Δηλαδή το α και το β μάλλον διαφέρουν στατιστικά σημαντικά απο το 0.Άρα υπάρχει στατιστικά σημαντική γραμμική εξάρτηση καταναλάσωης μεταξύ οξυγόνου και θερμοκρασίας.Καταλαβαίνουμε επίσης από αυτό πώς η ευθεία δεν περνάει απο τις αρχές των αξόνων. 
Η εξίσωση της ευθείας τελικά διαμορφώνεται έτσι: y= 3.547941 -0.084926x όπου y=Κατανάλωση οξυγόνου και x=θερμοκρασία
Έχει ελάχιστο το min=-0.14794, πρώτο τεταρτημόριο Q1=-0.10951, Διάμεσο median=-0.01100  τρίτο τεταρτημόριο Q3=0.08874 και μέγιστο max=0.22595

```{r}
confint(fit, level = 0.95)
```
>Διάστημα εμπιστοσύνης για τη σταθερά α 3.45139502<α<3.64448618
Γα τη κλίσης της ευθείας β είναι -0.09298803 < β < -0.07686347

```{r}
anova(fit)
```

>Με το F-test της ANOVA βλέπουμε τιμή στατιστικού F1,8=590.04, p.value = 8.803e-09 < 0.05. Επιβεβαιώνουμε λοιπόν πως σε επίπεδο σημαντικότητας 0.05 μάλλον απορρίπτουμε την αρχική υπόθεση πως η κλίση β της ευθείας είναι 0 (H0_β=0)


**Ερώτημα γ**

>Αρκεί να ανατρέξουμε το summary(fit) και να δούμε την τιμή στο multiple R-squared δηλαδη R2=0.9866. Αυτό σημαίνει ότι το 98.66% της μεταβλητότητας στην κατανάλωση οξυγόνου ερμηνεύεται από την γραμμική σχέση με τη θερμοκρασία

**Ερώτημα δ**

>Για να υπολογίσουμε τα διαστήματα εμπιστοσύνης για τη μέση τιμή της κατανάλωσης οξυγόνου θα χρησιμοποιήσουμε την συνάρτηση predict.

>Για την μέση τιμή των πτηνών

```{r}
predict(fit, list(Temp=12), interval="confidence", level=0.95)
```

>Το διάστημα εμπιστοσύνης για την αναμενόμενη μέση τιμή ενός ατόμου είναι (2.396797,2.660866)


```{r}
predict(fit, list(Temp=12), interval="prediction", level=0.95)
```
>Ενώ για την προβλεπόμενη μέση τιμή ενός ατόμου των πτηνών (2.196826,2.860837)


>Το διάστημα εμπιστοσύνης της προβλεπόμενης μέσης τιμής είναι (2.196826,2.860837)
>Βλέπουμε πως η προβλεπόμενη μέση τιμή κατανάλωσης οξυγόνου έχει μεγαλύτερο διάστημα εμπιστοσύνης απο αυτό της αναμενόμενης κατανάλωσης και αυτό συμβαίνει γιατί όταν προβλέπουμε μέση τιμή ενός ατόμου υπάρχει μια επιπλέον μεταβλητότητα λόγω διασποράς των τιμών y γύρω απο τη μέση τιμή

**Ερώτημα ε**

>Θα χρησιμοποιήσουμε πάλι την ίδια συνάρτηση predict() απλά αυτή τη φορά θα του δώσουμε διάστημα αντί για συγκεκριμένη τιμή, και έτσι θα υπολογίσει για όλες τις τιμές τα διαστήματα εμπιστοσύνης, πρώτα για τις αναμενόμενες τιμές

```{r}
xx1<-predict(fit, list(Temp=c(-18,-15,-10,-5,0,5,7,10,15,19)), interval="confidence", level=0.95)
xx1
```

>Και στη συνέχεια και τις προβλεπόμενες

```{r}
xx2<-predict(fit, list(Temp=c(-18,-15,-10,-5,0,5,7,10,15,19)), interval="prediction", level=0.95)
xx2
```

>Τώρα θα φτιάξουμε το plot μας. Θα γίνει χρήση των προηγούμενων εντολών για το plot μαζί με τις εντολές lines() για να δούμε τις καμπύλες και βρήκαμε μια ακόμα συνάρτηση για να φανούν τα διαστήματα εμπιστοσύνης, την arrows(). Επειδή οι γραμμές ηταν πολύ λεπτές με το lwd αυξήσαμε το "πάχος" τους. Όσον αφορά τη συνάρτηση lines, χρησιμοποιούμε την δεύτερη (lower) και τρίτη (upper) στήλη που μας δόθηκε απο τη συνάρτηση predict. Έτσι το ο άξονας χ είναι η θερμοκρασίας και σαν y έχουμε τα άνω [,3] και κάτω [,2] όρια.Ανοιχτό μπλέ είναι οι προβλεπόμενες, και ανοιχτό κόκκινο οι αναμενόμενες. Ομοίως με τη συνάρτηση arrows δείχνουμε το δίαστημα εμπιστοσύνης για τα σημεία. Σκούρο μπλε για τις προβλεπόμενες, και σκούρο κόκκινο για τις αναμενόμενες.

```{r}
plot(Temp,Oxy,pch=19, xlab="Temperature (Celsius)", ylab="Oxygen")
abline(fit,lwd=2, col="darkgreen")
lines(Temp,xx1[,2], col="firebrick 1",lwd=2)
lines(Temp,xx1[,3], col="firebrick 1",lwd=2)
lines(Temp,xx2[,2], col="cyan",lwd=2)
lines(Temp,xx2[,3], col="cyan",lwd=2)
arrows(Temp, xx1[,2], Temp, xx1[,3], length=0.05, angle=90, code=3, col="darkred", lwd=2)
arrows(Temp, xx2[,2], Temp, xx2[,3], length=0.05, angle=90, code=3, col="navy", lwd=2)
```

