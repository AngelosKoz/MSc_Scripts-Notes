---
title: "BIO2372"
author: "Αγγελος Κοζωνακης"
date: "12/10/2021"
output:
  html_document: default
---

**Εργαστηριακή άσκηση 2**

**Άσκηση πρώτη**

>Θέλουμε να εξετάσουμε αν μπορουν διαχωριστούν και τα 3 πτηνά μεταξύ τους με βάση το χρόνο κελαηδίσματος σε επίπεδο σημαντικότητας 95%. Θα συγκρίνουμε λοιπόν τους μέσους χρόνους κελαηδίσματος. Αυτός ο έλεγχος εφόσον έχουν 3 πτηνά δηλαδή 3 μεταβλητές θα γίνει έλεγχος με χρήση Anova (οι εντολές που χρησιμοποιούνται πραγματοποιούνται για conf.level=0,95. Για να κάνουμε όμως χρήση Anova πρέπει να δούμε αν πληρούνται οι προϋποθέσεις. Αυτές είναι οι εξής:
*Οι παρατηρήσεις να είναι ανεξάρτητες (έχουμε διαφορετικά είδη άρα πληρείται η προϋπόθεση αυτή)
*Κάθε μεταβλητή δηλαδή κάθε πτηνό πρέπει να ακολουθεί κανονική κατανομή.
*Οι 3 πληθυσμοί πουλιών να έχουν ίδιες διασπορές

>Αρχικά περνάω τα δεδομένα σε ενα .txt αρχείο για να μπορώ να κάνω πιο εύκολα την σύγκριση. Εφόσον έχουν περαστεί τα δεδομένα αρκεί τώρα να τα διαβάσω.

```{r}
setwd("I:/Bstat/RR")
birds<-read.table("Birds.txt", header=T, dec = ",")
attach(birds)
```

>Αφού κάναμε το attach τώρα με την συνάρτηση tapply θα βρούμε αντίστοιχα τη μέση τιμή και διασπορά των πτηνών με την tapply που θα εφαρμόσει το mean,var σε όλα τα επίπεδα.

```{r}
tapply(TIME,BIRD,mean)
tapply(TIME,BIRD,var)
```

>Η μηδενική μας υπόθεση H0 είναι ότι ο μέσος χρόνος κελαηδίσματος είναι ίδιος μεταξύ των πτηνών και δεν φέρει σημαντικές διαφορές ώστε να διαχωριστούν τα πτηνά. Δηλαδή υποθέτουμε ότι μpyr=μpeu=μpso, και εναλλακτική Η1 ότι ο μέσος χρονος δεν είναι ίδιος μεταξύ των πτηνών, δηλαδή ότι κάποιο απο τα 3 διαφέρει.
Πάμε τώρα να κάνουμε έλεγχο των προϋποθέσεων. Θα δούμε λοιπόν με boxplot και Shapiro test αν ακολουθούν κανονική κατανομή το καθένα ξεχωριστά.

```{r}
boxplot(TIME~BIRD)
```

>Βλέπουμε πως δεν υπάρχουν σημαντικά παράτυπα σημεία και δεν αποκλύουν οι κατανομες απο τη συμμετρία(είναι ίσης η διάμεσος στη μέση του ορθογωνίου)
Πρέπει τώρα να χωρίσουμε τις μεταβλητές μας για να γίνει ξεχωριστά ο έλεγχος.

```{r}
bird.pyr<-TIME[BIRD=="Pyr"]
bird.peu<-TIME[BIRD=="Peu"]
bird.pso<-TIME[BIRD=="Pso"]
```

>Και τώρα που τις χωρίσαμε βλέπουμε αν κάθε μια απο αυτές ακολουθεί κανονική κατανομή

```{r}
shapiro.test(bird.pyr)
shapiro.test(bird.peu)
shapiro.test(bird.pso)
```

>Πέρνουμε τις τιμές p-value=0.778,0.9489,0.6515 αντίστοιχα, που είναι μεγαλύτερες απο το 0.05, και άρα όλες μπορούμε να πούμε ότι το πιο πιθανό να προέρχονται απο κανονική κατανομή.

>Τώρα πρέπει να δούμε αν υπάρχει ομοιογένεια στις διασπορές, και αυτό θα γίνει με τη χρήση Levene τεστ, το οποίο κετράρει απο μόνο του στη .

```{r}
library(car)
leveneTest(TIME~BIRD)
```

>Παίρνουμε F2,27=0.7186 και p=0.4965 άρα δεν παρατηρούμε στατιστικά σημαντική διαφορά στις διασπορές. Μπορόυμε λοιπόν τώρα που εξετάσαμε τις προϋποθέσεις να εφαρμόσουμε Anova.

```{r}
anova<-aov(TIME~BIRD)
summary(anova)
```

>Βλέπουμε πως P(F2,27≥103.7|H0)=2,13e-13, μια τιμή πολύ μικρή, συνεπώς η μηδενική μας υπόθεση σε confidence level=0.95 απορρίπτεται. Άρα μπορούμε να πούμε πως ο χρόνος κελαηδίσματος των πτηνών είναι ενα χαρακτηριστικό που διαχωρίζει μεταξύ τους.


**Άσκηση δεύτερη**

>Θεωρούμε οτι κάθε μέτρηση είναι ανεξάρτητη και οτι η δειγματολιψεια έγινε τυχαία.
Ετσι λοιπόν έχουμε σαν Η0 υπόθεση οτι η αναλογίας των τεσσάρων αυτών φαινοτύπων ειναι 9/3/3/1, και Η1 ότι κάποιο απο αυτά έχει διαφορετική αναλογία.
Για να ελέγξουμε πόσο πιθανό ειναι να έχουν προέλθει παρατηρούμενες αναλογίες απο έναν πληθυσμό θα χρειαστέι να εφαρμόσουμε τεστ χ²-καλής προσαρμογής.
Αρχικλα θα δημιουργήσουμε ένα διάνυσμα για τις παρατηρούμενες μας τιμές και ένα για τις αναμενόμενες τιμές. Ξέρουμε ότι n=250 αλλά το επιβεβαιώνουμε με τον παρακάτω τύπο.

```{r}
observed <- c(152, 39, 53, 6)
n <- sum(observed)
n
p0 <- c(9/16, 3/16, 3/16, 1/16)
expect <- n*p0
expect
```

>Τώρα μπορούμε να δούμε την τιμή του στατιστικού μας χ²

```{r}
chi2 <- sum((observed-expect)^2/expect)
chi2
```

>Αφού έχουμε βρεί την τιμή του στατιστικού μας, θα βρούμε την περιοχή απόρριψης της Η0. Το πλήθος εδώ είναι κ=4 άρα έχουμε 3 βαθμούς ελευθερίας.

```{r}
chi.value<-qchisq(0.05, 3, lower.tail = F)
chi.value
```

>Βλέπου ότι η τιμή του στατιστικού 8.97 μεγαλύτερη απο το 7.81 που είναι το διάστημα απόρριψης. Άρα ο Η0 μας με βάση αυτό απορρίπτεται σε επίπεδο σημαντικότητας α=0.05
Θα δούμε τώρα την σημαντικότητα του ελέγχου, δηλαδή P(χ²≥χ²κ-1|Η0 σωστή)

```{r}
p.value<-pchisq(chi2, 3, lower.tail=FALSE)
p.value
```

>Κάνοντας και το p-value παίρνουμε τιμή 0.02966<0.05. Σημαίνει ότι υπάρχει πιθανότητα να έχουμε κάνει σφάλμα τύπου 1. Ίσως χρειαζόμαστε μεγαλύτερο δείγμα.